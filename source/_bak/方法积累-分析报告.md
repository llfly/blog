
---
title: Tomcat Architecture
categories: 
    - java web
    - tomcat
date: {{ date }}
---

> 坚持做正确的事，而不是容易的事



### 分类
- 描述类报告（不求最深但求最全）
    - 发生了什么事？
- 因果类报告 （集中一点，一直探到低）
    - 发生了什么事？
    - 为什么发生？
- 预测类报告（根据市场的过去推断未来）
    - 发生了什么事？
    - （事情为什么会发生？）
    - 未来如何发展
- 咨询类报告（小马过河，投石问路，根据分析结论指引方向）
    - 发生了什么事？
    - （事情为什么发生？）
    - （未来如何发展）
    - 应该如何决策？

### 结构


### 思路
- 先想清楚几个问题
    - 写什么内容？
    - 用什么结构？
    - 如何描述？





〇. 实质
分析是针对目标、评估现状（what），再根据事情的发展规律建立演化路线、分解影响因素（how），并定位关键驱动因素、以解释现状的成因（why）。因此，在做分析之前，需要梳理清楚以下几点：

分析对象的发展目标是什么？
 比如，新PV表可替换老PV表


实现目标需要做到哪些？
 比如，新PV表需要实现：与老PV表相比，①数据质量一致、②数据规模一致、③就绪时间一致，才可实现对老PV表的替换
三个因素可再次细化——
       1. 数据质量包括：重复率、空值率、合规率等
       2. 数据规模包括：数据量、各维度分布占比
       3. 就绪时间涉及：数据的处理方式
这个过程就是在拆解目标、建立演化路线，也就是分析框架的初步建立。


是否具备对足够经验，以判断关键驱动因素？
 比如，根据对数据使用场景的了解可以得出判断：数据质量和数据规模是首要的，这会影响数据的真实性；就绪时间是次要的，这会影响数据的时效性

一. 结构

分析报告需要包括分析目的、预期特征、分析结论、分析过程、附录。

分析目的：阐述分析报告的赚些背景，即为了达到什么目标，做了哪些事情

 比如，为了将点评的PV表替换成新PV表，需要对新老数据的质量、规模、时效性等进行对比分析，以评估新数据可用性是否与老数据齐平


预期特征：阐述为了实现分析对象的发展目标，需要获得哪些充分条件，也就是将目标拆解和量化

 比如，1）数据质量方面：①新老PV表各字段可匹配，②新老PV表空值率差异不超过1%；2）数据规模方面：①新老PV表数据量差异不超过1%，②新老PV表核心维度分布占比差异不超过1%；3）时效性方面：新PV表的就绪时间不晚于老PV表的就绪时间


分析结论：阐述完成分析后得到的结论，用清晰、量化的方式展现预期特征的达成度、并判断分析对象是否达到发展目标
 比如，
      1）新PV表的数据质量部分符合预期
            a. 字段完全匹配
            b. 79%字段的空值率、值域一致；18%字段的空值率降低

         2）新PV表的数据规模部分符合预期

       a. 分重点页面统计，各指标偏差在  [0%，0.79%）之内，另，因美团侧不过滤延时上报日志，主站数据访次偏高1.6%

       b. 分平台统计，各指标偏差在   [0%,  1.27%]   之内，另，因美团侧不过滤延时上报日志，主站数据访次偏高3.6%

       c. 总体情况下，各指标偏差在   [0%,  1.19%）之内, 另，因美团侧不过滤延时上报日志，访次偏高3.1%

         3）新PV表时效性不符合预期，平均比老PV表晚了3个小时

        综上，新PV表的数据质量和数据规模部分符合预期特征，时效性比老PV表晚了3？个小时。新PV表的数据质量、数据规模和时效性有待提高，目前不建议切换。



4. 分析过程：尽阐述得到分析结论的过程，用数字和图表展示对各预期特征判断依据

     比如，

表1:PV数据规模对比

指标名称 

美团侧数据 

点评侧数据 

差异比率 

质量评估

结论

PV

410693321

405920457

1.18%

日志拉取情况两侧不一样，预期之内

各指标偏差在[0%,4%]之内

uv

13633991

13595292

0.28%

 OK

 

访次

35951122

34853253

3.15%

点评侧对日志延时上报的情况作了过滤，而美团侧没有，导致了session_id的数量偏高，可认为是正常的

 

日志量

411389507

406564575

1.19%

日志拉取情况两侧不一样，预期之内

 

备注：1）对账数据表：mart_data_audit.app_table_dimensions_mv_pv_num_check_daily；2）约束条件：①平台id=2（主APP）和6（M），②日期=20160928

5. 附录：视情况补充相关的分析材料，如用来统计分析的excel、sql、设置预期特征的依据出处等

二. 框架
分析框架是基于演化规律（通俗的说，就是判断过程），分解和组合影响因素的框架，比如脑图就是对框架最好的体现。预先建立框架，可以辅助我们全面、有条理地认识现象，也有助于做好分析过程的规划，比如先分析什么，后分析什么，重点分析什么。如何分解影响因素呢？

1）发散大脑，想到什么就记下来；或咨询专家，了解别人眼中的关键点

2）根据类型组装，比如流量是一类，交易是一类；数据质量是一类，数据规模是一类

3）仔细看对每一个因素，看看是否做到不重；再对每一类别进行发散，看看是否做到不漏（MECE原则）

上升到理论层面，就是要做到如下：

科学：客观真实地反映业务发展和演化状态

系统：全面、结构性、层次性地解读业务

实用：繁简适中、易于理解

动态：实时地反映业务变化

建立分析框架的过程实际就是将大脑中的想法进行梳理的过程，可以训练结构化思维能力，一方面是对自身认知的检验，另一方面也便于他人理解你的想法。

三. 数据
选取什么样的数据进行分析，这个需要基于分析的目的判断。

 比如，分析目的是【新PV表可替换老PV表】，这是为了完成对点评侧PV表的替换，那么就需要选取新PV表中的点评站点的数据

 比如，分析目的是【灵犀MGE上报质量分析】，这是为了检验灵犀最新版本的上报质量，那么就需要选取app_version>7.4的数据

数据的选取范围需要在报告中体现出来，可以在分析过程中、呈现图表的时候备注说明。

四. 呈现
观点的呈现需要做到有条理，易理解，不冲突。

1）有条理：即报告结构清晰，可以按照上述【分析目的-预期特征-分析结论-分析过程-附录】布局信息，也可以按照其他方式，只要做到逻辑清晰即可

2）易理解：即能让大部分关心的人迅速理解和认可分析报告的结论，一方面是用以分析佐证的数据准确，一方面是对数据的解读符合常理。最好能辅以图表、符号、醒目的颜色、突出的字体等帮助他人看到重点。可以试着自己多读几遍，如果愿意读第三遍，那就算是容易理解了。

3）不冲突：即报告中的数据与数据、数据与结论、结论与预期、预期与目标互不冲突。通常来说，明确目标，以终为始，不会有大的出入

做到以上三点，就可以交差啦~~~~~

五. 样例
要做好上述所有需要对分析报告反复打磨，鄙人的分析报告写得也是很勉强（X_X）… 之前做过一份简单的报告，感觉是最乐意重读的，供参考：PV POI/Deal UV 对账

希望大家写得更好~~





1. 如何写分析报告

1. 闭环思维
- 开会后输出 TODO
- 分析报告 - 分析 - 输出结论 - 总结问题 - 根据问题输出 TODO